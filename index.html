<!doctype html>
<html lang="en">
<head>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/turn.js/4.1.1/turn.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
<style>
/* Dnyanvani Custom Styles */
#canvas { position: relative; width: 100%; height: 100vh; }
.sj-book { background: #f5f5f5; box-shadow: 0 0 20px rgba(0,0,0,0.2); }
.dnyanvani-header { 
    position: absolute; 
    top: 20px; 
    width: 100%; 
    text-align: center; 
    color: #2c3e50;
    z-index: 1000;
    font-family: Arial, sans-serif;
}
.hard { background: #1a2b3c !important; }
.page-content { padding: 20px; }
</style>
</head>
<body>

<div class="dnyanvani-header">
    <h1>Dnyanvani 90.4FM Community Radio</h1>
    <h3>ज्ञानवाणी - जनतेचे रेडिओ</h3>
</div>

<div id="canvas">
    <div id="book-zoom">
        <div class="sj-book">
            <!-- Covers -->
            <div depth="5" class="hard"><div class="side"></div></div>
            <div depth="5" class="hard front-side"><div class="depth"></div></div>
            
            <!-- Dynamic pages will be inserted here -->
            
            <!-- Back covers -->
            <div class="hard fixed back-side"><div class="depth"></div></div>
            <div class="hard"></div>
        </div>
    </div>
    <div id="slider-bar" class="turnjs-slider">
        <div id="slider"></div>
    </div>
</div>

<script type="text/javascript">
function loadApp() {
    const totalPages = 32; // 30 content + 2 covers
    const flipbook = $('.sj-book');

    // Initialize slider
    $("#slider").slider({
        min: 1,
        max: totalPages,
        slide: function(event, ui) {
            flipbook.turn('page', ui.value);
        }
    });

    // Initialize flipbook
    flipbook.turn({
        elevation: 50,
        acceleration: true,
        autoCenter: true,
        gradients: true,
        duration: 1000,
        pages: totalPages,
        when: {
            turned: function(e, page) {
                $("#slider").slider("value", page);
                // Handle page boundaries
                if(page < 2) flipbook.turn('page', 2);
                if(page > totalPages-1) flipbook.turn('page', totalPages-1);
            },
            missing: function(e, pages) {
                pages.forEach(page => {
                    const img = page === 1 ? 'front.png' :
                              page === totalPages ? 'back.png' :
                              `${page-1}.png`;
                    this.addPage(
                        `<div class="page-content">
                            <img src="${img}" style="max-width:100%; height:100%; object-fit:contain;">
                         </div>`,
                        page
                    );
                });
            }
        }
    });

    // Keyboard navigation
    $(document).on('keydown', function(e) {
        if(e.keyCode === 37) flipbook.turn('previous');
        if(e.keyCode === 39) flipbook.turn('next');
    });

    // Touch support
    if($.isTouch) {
        flipbook.on('touchend', function(e) {
            const touch = e.originalEvent.changedTouches[0];
            const x = touch.pageX;
            const w = $(this).width()/2;
            if(x > w) $(this).turn('next');
            else $(this).turn('previous');
        });
    }
}

// Initialize application
$(window).on('load', loadApp);
</script>

</body>
</html>
